@using FilterType = Syncfusion.Blazor.Grids.FilterType
@using EditMode = Syncfusion.Blazor.Grids.EditMode
@using BedBrigade.Common.Models

@if (Locations == null || lstPrimaryLanguage == null || BedRequests == null)
{
    <Spinner />
}
else
{
    <div class="row">
        <div class="col-md-10 mt-3">
            <h3>@ManageBedRequestsMessage</h3>
        </div>
        <div class="col-md-2 mt-3">
            <UserInfo />
        </div>
    </div>
    <div class="col-md-12 control-sec">
        <div class="content-wrapper">
            <div class="row">

                <SfGrid @ref="Grid" TValue="BedRequest" DataSource=@BedRequests
                        ContextMenuItems=@ContextMenu
                        EnablePersistence="true"
                        ShowColumnChooser="true"
                        Toolbar=@ToolBar
                        AllowPaging="true"
                        AllowSorting="true"
                        AllowExcelExport="true"
                        ShowColumnMenu="false"
                        AllowFiltering="true"
                        AllowReordering="true"
                        AllowResizing="true"
                        AllowSelection="true"
                        AllowPdfExport="true"
                        AllowTextWrap="false"
                        AllowGrouping="true"                        
                        Width="100%"
                        ClipMode="ClipMode.EllipsisWithTooltip">
                    <GridPageSettings PageSizes="@(new int[] { 5, 10, 15, 20, 25 })" PageSize="15" />
                    <GridEditSettings ShowDeleteConfirmDialog="true"></GridEditSettings>
                    <GridEvents DataBound=@DataBound
                                Destroyed=@OnDestroyed
                                OnLoad=@OnLoad
                                OnToolbarClick=@OnToolBarClick
                                OnActionBegin=@OnActionBegin
                                TValue="BedRequest" />
                    <GridTemplates>
                        <EmptyRecordTemplate>
                            <span>@RecordText</span>
                        </EmptyRecordTemplate>
                    </GridTemplates>

                    <GridFilterSettings Type="FilterType.CheckBox"></GridFilterSettings>
                    <GridSortSettings>
                        <GridSortColumns>
                            <GridSortColumn Field="@nameof(BedRequest.CreateDate)" Direction="SortDirection.Ascending" />
                        </GridSortColumns>
                    </GridSortSettings>
                    <GridColumns>
                        <GridColumn Field=@nameof(BedRequest.BedRequestId) IsPrimaryKey="true" Visible="false" ShowInColumnChooser="true" />
                        <GridForeignColumn Field=@nameof(BedRequest.LocationId) Width="172" Visible="false" ShowColumnMenu="false" HeaderText="Location" ForeignDataSource=@Locations ForeignKeyField="LocationId" ForeignKeyValue="Name" AllowFiltering="true" AllowGrouping="true" />
                        <GridColumn Field=@nameof(BedRequest.FullName) Width="172" ShowColumnMenu="false" HeaderText="Name" Type="ColumnType.String" AllowEditing="false" AllowFiltering="true" />
                        <GridColumn Field=@nameof(BedRequest.FormattedPhone) Width="118" ShowColumnMenu="false" HeaderText="Phone" Type="ColumnType.String" AllowEditing="false" AllowFiltering="true" />
                        <GridColumn Field=@nameof(BedRequest.Street) Width="175" ShowColumnMenu="false" HeaderText="Address" Type="ColumnType.String" AllowEditing="false" AllowFiltering="true" />
                        <GridColumn Field=@nameof(BedRequest.PostalCode) Width="90" ShowColumnMenu="false" HeaderText="Zip" Type="ColumnType.String" AllowEditing="false" AllowFiltering="true" AllowGrouping="true" />
                        <GridColumn Field=@nameof(BedRequest.CreateDate) Width="100" Format="d" ShowColumnMenu="false" HeaderText="Added" Type="ColumnType.Date" AllowEditing="false" AllowFiltering="false" />
                        <GridColumn Field=@nameof(BedRequest.Group) Width="100" ShowColumnMenu="false" HeaderText="Group" Type="ColumnType.String" AllowEditing="false" AllowFiltering="true" CustomAttributes="@(new Dictionary<string, object> { { "class", "center-column" } })" />
                        <GridColumn Field=@nameof(BedRequest.NumberOfBeds) Width="100" ShowColumnMenu="false" HeaderText="Beds" Type="ColumnType.Integer" AllowEditing="false" AllowFiltering="true" CustomAttributes="@(new Dictionary<string, object> { { "class", "center-column" } })" />
                        <GridColumn Field=@nameof(BedRequest.StatusString) Width="100" ShowColumnMenu="false" HeaderText="Status" Type="ColumnType.String" AllowEditing="false" AllowFiltering="true" />
                        <GridColumn Field=@nameof(BedRequest.ContactedYes) Width="110" ShowColumnMenu="false" HeaderText="Contacted" Type="ColumnType.String" AllowEditing="false" AllowFiltering="true" CustomAttributes="@(new Dictionary<string, object> { { "class", "center-column" } })" />
                        <GridColumn Field=@nameof(BedRequest.GenderAge) Width="225" ShowColumnMenu="false" HeaderText="Gender/Age" Type="ColumnType.String" AllowEditing="false" AllowFiltering="false" CustomAttributes="@(new Dictionary<string, object> { { "class", "center-column" } })" />
                        <GridColumn Field=@nameof(BedRequest.DeliveryDate) Width="125" Format="d" ShowColumnMenu="false" HeaderText="Delivered" Type="ColumnType.Date" AllowEditing="false" AllowFiltering="true" />
                        <GridColumn Field=@nameof(BedRequest.Reference) Width="125" ShowColumnMenu="false" HeaderText="Reference" Type="ColumnType.String" AllowEditing="false" AllowFiltering="true" AllowGrouping="false" />
                        <GridColumn Field=@nameof(BedRequest.Notes) Width="425" ShowColumnMenu="false" HeaderText="Notes" Type="ColumnType.String" AllowEditing="false" AllowFiltering="false" />
                        <GridColumn Field=@nameof(BedRequest.Team) Width="100" ShowColumnMenu="false" HeaderText="Team" Type="ColumnType.String" AllowEditing="false" AllowFiltering="true" AllowGrouping="false" />
                        <GridColumn Field=@nameof(BedRequest.BedType) Width="100" ShowColumnMenu="false" HeaderText="Bed Type" Type="ColumnType.String" AllowEditing="false" AllowFiltering="true" AllowGrouping="false" />
                        <GridColumn Field=@nameof(BedRequest.Names) Width="200" ShowColumnMenu="false" HeaderText="Names" Type="ColumnType.String" AllowEditing="false" AllowFiltering="true" AllowGrouping="false" />
                        <GridColumn Field=@nameof(BedRequest.PrimaryLanguage) Width="150" ShowColumnMenu="false" HeaderText="Language" Type="ColumnType.String" AllowEditing="false" AllowFiltering="true" AllowGrouping="false" />
                        <GridColumn Field=@nameof(BedRequest.SpeakEnglish) Width="200" ShowColumnMenu="false" HeaderText="Speak English" Type="ColumnType.String" AllowEditing="false" AllowFiltering="true" />
                        <GridColumn Field=@nameof(BedRequest.UpdateDateLocal) Width="150" Format="g" ShowColumnMenu="false" HeaderText="Updated" Type="ColumnType.Date" AllowEditing="false" AllowFiltering="false" />
                        <GridColumn Field=@nameof(BedRequest.Distance) ShowColumnMenu="false" HeaderText="Distance" Format="N3" Type="ColumnType.Number" AllowEditing="false" AllowFiltering="false" />
                    </GridColumns>
                </SfGrid>
            </div>
        </div>
    </div>
}


<SfDialog Width="300px" ShowCloseIcon="true" IsModal="true" @bind-Visible="@IsDialogVisible">
    <DialogTemplates>
        <Header>@DialogHeader</Header>
        <Content>@DialogContent</Content>
    </DialogTemplates>
    <DialogButtons>
        <DialogButton Content="OK" IsPrimary="true" OnClick="@DialogOkClick" />
    </DialogButtons>
</SfDialog>

@if (NoPaging)
{
    <style>
        .e-pager {
            display: none;
        }
    </style>
}

<style>
    /***************************************** BedRequestGrid.razor.css ********************************************/

    .e-grid td.e-rowcell.e-focus.e-focused {
        box-shadow: none;
    }

    .e-grid th.e-headercell.e-focus.e-focused {
        box-shadow: none;
    }

    .e-dialog .e-dlg-header {
        font-size: 1.75rem;
        font-weight: 700;
    }

    .custom-textbox-height {
        height: 80px;
    }

    /* ============= Grid Header Height */
    /* Adjust the header row height */
    .e-grid .e-headercell {
        height: 60px; /* Set to desired height */
        line-height: 60px; /* Vertically center the text */
    }

    /* Optional: Adjust header text alignment */
    .e-grid .e-headertext {
        display: flex;
        align-items: center;
        height: 100%;
    }

    .center-column {
        text-align: center;
    }

</style>
